<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>HashMapæºç è§£æ | Fabian Bao</title><meta name="keywords" content="java,æºç ,jdk,HashMap"><meta name="author" content="Fabian Bao"><meta name="copyright" content="Fabian Bao"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="HashMapæºç è§£æ">
<meta property="og:type" content="article">
<meta property="og:title" content="HashMapæºç è§£æ">
<meta property="og:url" content="https://fabian4.site/blog/14375.html">
<meta property="og:site_name" content="Fabian Bao">
<meta property="og:description" content="HashMapæºç è§£æ">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://fabian.oss-cn-hangzhou.aliyuncs.com/img/LuciolaCruciata_ZH-CN9063767400_1920x1080.jpg">
<meta property="article:published_time" content="2021-03-26T16:00:00.000Z">
<meta property="article:modified_time" content="2022-08-24T07:47:19.050Z">
<meta property="article:author" content="Fabian Bao">
<meta property="article:tag" content="java">
<meta property="article:tag" content="æºç ">
<meta property="article:tag" content="jdk">
<meta property="article:tag" content="HashMap">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://fabian.oss-cn-hangzhou.aliyuncs.com/img/LuciolaCruciata_ZH-CN9063767400_1920x1080.jpg"><link rel="shortcut icon" href="https://fabian.oss-cn-hangzhou.aliyuncs.com/img/202015ouknbvshlsrvbku5.jpeg.icon.png"><link rel="canonical" href="https://fabian4.site/blog/14375"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/blog/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-E90K5222F4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-E90K5222F4');
</script><script>const GLOBAL_CONFIG = { 
  root: '/blog/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç°¡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: 'å¤©',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'HashMapæºç è§£æ',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-08-24 15:47:19'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.2.0"><link rel="alternate" href="/blog/atom.xml" title="Fabian Bao" type="application/atom+xml">
</head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://fabian4.site/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/blog/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">73</div></a><a href="/blog/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">54</div></a><a href="/blog/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">16</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/blog/archives/"><i class="fa-fw fa fa-archive"></i><span> å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page" href="/blog/tags/"><i class="fa-fw fa fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/blog/categories/"><i class="fa-fw fa fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/blog/link/"><i class="fa-fw fa fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/blog/read/"><i class="fa-fw fa fa-book"></i><span> é˜…è¯»</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://fabian.oss-cn-hangzhou.aliyuncs.com/img/LuciolaCruciata_ZH-CN9063767400_1920x1080.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/blog/">Fabian Bao</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/blog/archives/"><i class="fa-fw fa fa-archive"></i><span> å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page" href="/blog/tags/"><i class="fa-fw fa fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/blog/categories/"><i class="fa-fw fa fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/blog/link/"><i class="fa-fw fa fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/blog/read/"><i class="fa-fw fa fa-book"></i><span> é˜…è¯»</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">HashMapæºç è§£æ</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2021-03-26T16:00:00.000Z" title="å‘è¡¨äº 2021-03-27 00:00:00">2021-03-27</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2022-08-24T07:47:19.050Z" title="æ›´æ–°äº 2022-08-24 15:47:19">2022-08-24</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/blog/categories/jdk%E6%BA%90%E7%A0%81/">jdkæºç </a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">4.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>20åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="HashMapæºç è§£æ"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">è¯„è®ºæ•°:</span><a href="/blog/14375.html#post-comment"><span class="gitalk-comment-count"><i class="fa-solid fa-spinner fa-spin"></i></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="HashMapæºç è§£æ"><a href="#HashMapæºç è§£æ" class="headerlink" title="HashMapæºç è§£æ"></a>HashMapæºç è§£æ</h1><p>ä½œä¸ºé¢è¯•å¿…é—®çš„hashmapï¼Œæˆ‘ä»¬ä»Šå¤©æ¥ä¸€èµ·æ¥æ¢ç©¶ä¸€ä¸‹ä»–çš„æºç ã€‚è¿™é‡Œå…ˆè´´ä¸€å¼  hashmap çš„å†…éƒ¨ç±»å’Œéƒ¨åˆ†æ–¹æ³•å‡½æ•°</p>
<img src="https://fabian.oss-cn-hangzhou.aliyuncs.com/img/image-20210921204040629.png" alt="image-20210921204040629" style="zoom: 67%;" />

<h2 id="ä¸€ã€ä»€ä¹ˆæ˜¯-å“ˆå¸Œï¼Œ-å“ˆå¸Œå‡½æ•°ï¼ˆæ•£åˆ—å‡½æ•°ï¼‰"><a href="#ä¸€ã€ä»€ä¹ˆæ˜¯-å“ˆå¸Œï¼Œ-å“ˆå¸Œå‡½æ•°ï¼ˆæ•£åˆ—å‡½æ•°ï¼‰" class="headerlink" title="ä¸€ã€ä»€ä¹ˆæ˜¯ å“ˆå¸Œï¼Œ å“ˆå¸Œå‡½æ•°ï¼ˆæ•£åˆ—å‡½æ•°ï¼‰"></a>ä¸€ã€ä»€ä¹ˆæ˜¯ å“ˆå¸Œï¼Œ å“ˆå¸Œå‡½æ•°ï¼ˆæ•£åˆ—å‡½æ•°ï¼‰</h2><blockquote>
<p>Hashï¼Œä¸€èˆ¬ç¿»è¯‘åšæ•£åˆ—ã€æ‚å‡‘ï¼Œæˆ–éŸ³è¯‘ä¸ºå“ˆå¸Œï¼Œæ˜¯æŠŠä»»æ„é•¿åº¦çš„<a target="_blank" rel="noopener external nofollow noreferrer" href="https://baike.baidu.com/item/%E8%BE%93%E5%85%A5/5481954">è¾“å…¥</a>ï¼ˆåˆå«åšé¢„æ˜ å°„pre-imageï¼‰é€šè¿‡æ•£åˆ—ç®—æ³•å˜æ¢æˆå›ºå®šé•¿åº¦çš„<a target="_blank" rel="noopener external nofollow noreferrer" href="https://baike.baidu.com/item/%E8%BE%93%E5%87%BA/11056752">è¾“å‡º</a>ï¼Œè¯¥è¾“å‡ºå°±æ˜¯æ•£åˆ—å€¼ã€‚è¿™ç§è½¬æ¢æ˜¯ä¸€ç§<a target="_blank" rel="noopener external nofollow noreferrer" href="https://baike.baidu.com/item/%E5%8E%8B%E7%BC%A9%E6%98%A0%E5%B0%84/5114126">å‹ç¼©æ˜ å°„</a>ï¼Œä¹Ÿå°±æ˜¯ï¼Œæ•£åˆ—å€¼çš„ç©ºé—´é€šå¸¸è¿œå°äºè¾“å…¥çš„ç©ºé—´ï¼Œä¸åŒçš„è¾“å…¥å¯èƒ½ä¼šæ•£åˆ—æˆç›¸åŒçš„è¾“å‡ºï¼Œæ‰€ä»¥ä¸å¯èƒ½ä»æ•£åˆ—å€¼æ¥ç¡®å®šå”¯ä¸€çš„è¾“å…¥å€¼ã€‚ç®€å•çš„è¯´å°±æ˜¯ä¸€ç§å°†ä»»æ„é•¿åº¦çš„æ¶ˆæ¯å‹ç¼©åˆ°æŸä¸€å›ºå®šé•¿åº¦çš„<a target="_blank" rel="noopener external nofollow noreferrer" href="https://baike.baidu.com/item/%E6%B6%88%E6%81%AF%E6%91%98%E8%A6%81/4547744">æ¶ˆæ¯æ‘˜è¦</a>çš„å‡½æ•°ã€‚</p>
</blockquote>
<p>ä¸Šé¢æ˜¯ç™¾åº¦ç™¾ç§‘çš„è§£é‡Šã€‚æˆ‘ä»¬å¯ä»¥ç®€å•çš„æ¦‚æ‹¬ä¸º</p>
<ul>
<li>hash å°±æ˜¯å°† <strong>ä»»æ„çš„è¾“å…¥</strong> é€šè¿‡ ä¸€ç§ <strong>ç‰¹æ®Šçš„ç®—æ³•</strong> å˜æˆ <strong>é•¿åº¦å›ºå®š</strong> çš„è¾“å‡ºã€‚ </li>
<li>å¯ä»¥ç±»ä¼¼äºä¸€ç§æ‘˜è¦ç®—æ³•ï¼Œè·å–æˆ‘ä»¬è¾“å…¥å†…å®¹çš„ç‰¹å¾æ¥ç”Ÿæˆä¸€ä¸ªç®€çŸ­çš„æ‘˜è¦</li>
<li>ç”±äºç®—æ³•å¯ä»¥ä¿è¯ï¼šç›¸åŒçš„è¾“å…¥æ¯æ¬¡éƒ½æ˜¯å¯ä»¥å¾—åˆ°ç›¸åŒçš„è¾“å‡ºï¼Œå³hashå€¼</li>
<li>ä½†æ˜¯ä¹Ÿä¼šå‘ç”Ÿï¼šä¸åŒçš„è¾“å…¥å“ˆå¸Œä¹‹åä¼šå¾—åˆ°ç›¸åŒçš„ç»“æœ <strong>å³ å“ˆå¸Œå†²çª</strong></li>
</ul>
<h3 id="object-ä¸­çš„-hashcode-æ–¹æ³•"><a href="#object-ä¸­çš„-hashcode-æ–¹æ³•" class="headerlink" title="object ä¸­çš„ hashcode æ–¹æ³•"></a>object ä¸­çš„ hashcode æ–¹æ³•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">native</span> <span class="type">int</span> <span class="title function_">hashCode</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure>

<p>æ–¹æ³•æœ¬èº«æ˜¯ native æ–¹æ³•ï¼Œè°ƒç”¨äº†åº•å±‚çš„çš„ç±»åº“ï¼Œæ ¹æ®æ³¨é‡Šï¼š</p>
<p>hashCode éµå®ˆç€å¦‚ä¸‹çš„çº¦å®šï¼š</p>
<ul>
<li>Whenever it is invoked on the same object more than once during an execution of a Java application, the hashCode method must consistently return the same integer, provided no information used in equals comparisons on the object is modified. This integer need not remain consistent from one execution of an application to another execution of the same application.</li>
<li>If two objects are equal according to the equals(Object) method, then calling the hashCode method on each of the two objects must produce the same integer result.</li>
<li>It is not required that if two objects are unequal according to the equals(Object) method, then calling the hashCode method on each of the two objects must produce distinct integer results. However, the programmer should be aware that producing distinct integer results for unequal objects may improve the performance of hash tables.</li>
</ul>
<p>ç¿»è¯‘ä¸€ä¸‹å°±æ˜¯</p>
<ul>
<li><p>åœ¨ç¨‹åºä¸€æ¬¡æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œæ— è®ºä½•æ—¶è¢«è°ƒç”¨ï¼Œè¿™ä¸ªæ–¹æ³•éƒ½ä¼šè¿”å›ç›¸åŒçš„å€¼ã€‚ä½†æ˜¯ç¨‹åºçš„å¤šæ¬¡æ‰§è¡Œå°±ä¸èƒ½ä¿è¯æ¯ä¸€æ¬¡éƒ½ç›¸ç­‰</p>
</li>
<li><p>å¦‚æœä¸¤ä¸ªå¯¹è±¡çš„ equals æ–¹æ³•è¿”å› trueï¼Œé‚£ä¹ˆä»–ä»¬è°ƒç”¨æ­¤æ–¹æ³•å°±ä¸€å®šè¿”å›ç›¸åŒçš„ç»“æœ</p>
</li>
<li><p>å½“ç„¶ä¹Ÿä¸ä¸€å®šè¦ç¡®ä¿ï¼šä¸¤ä¸ªå¯¹è±¡å¦‚æœæ ¹æ®é‡å†™çš„ equals æ–¹æ³•è¿”å›ä¸º falseï¼Œé‚£ä¹ˆæ­¤æ–¹æ³•çš„è¿”å›ç»“æœä¸€å®šä¸åŒã€‚</p>
<blockquote>
<p>å³ï¼šä¸¤ä¸ªå¯¹è±¡ æ ¹æ®é‡å†™çš„equalsåˆ¤æ–­ä¸ºä¸ç›¸ç­‰ï¼Œæ­¤æ—¶çš„ hashcode ä¹Ÿå¯ä»¥ç›¸åŒ</p>
<p>ä¸è¿‡æˆ‘ä»¬åœ¨å†™ç¨‹åºæ—¶åº”è¯¥æ³¨æ„å°½é‡æ˜¯ä¸åŒçš„å¯¹è±¡è¿”å›ä¸åŒçš„hashcodeï¼Œä»¥ä¾¿åŠ å¼ºå“ˆå¸Œæ•ˆç‡ï¼Œé¿å…å“ˆå¸Œå†²çª</p>
</blockquote>
</li>
</ul>
<h3 id="hashmap-é‡‡ç”¨çš„å“ˆå¸Œæ–¹æ³•"><a href="#hashmap-é‡‡ç”¨çš„å“ˆå¸Œæ–¹æ³•" class="headerlink" title="hashmap é‡‡ç”¨çš„å“ˆå¸Œæ–¹æ³•"></a>hashmap é‡‡ç”¨çš„å“ˆå¸Œæ–¹æ³•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="title function_">hash</span><span class="params">(Object key)</span> &#123;</span><br><span class="line">    <span class="type">int</span> h;</span><br><span class="line">    <span class="comment">// è¿™é‡Œå½“ key ä¸ä¸º null çš„æ—¶å€™ï¼Œå°†keyçš„å“ˆå¸Œå€¼ å’Œ å³ç§»16ä½çš„å“ˆå¸Œå€¼ åšå¼‚æˆ–è¿ç®—</span></span><br><span class="line">    <span class="keyword">return</span> (key == <span class="literal">null</span>) ? <span class="number">0</span> : (h = key.hashCode()) ^ (h &gt;&gt;&gt; <span class="number">16</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://fabian.oss-cn-hangzhou.aliyuncs.com/img/image-20210924132832294.png" alt="image-20210924132832294"></p>
<p>å°†hæ— ç¬¦å·å³ç§»16ä¸ºç›¸å½“äºå°†é«˜åŒº16ä½ç§»åŠ¨åˆ°äº†ä½åŒºçš„16ä½ï¼Œå†ä¸åŸhashcodeåšå¼‚æˆ–è¿ç®—ï¼Œå¯ä»¥<strong>å°†é«˜ä½ä½äºŒè¿›åˆ¶ç‰¹å¾æ··åˆèµ·æ¥</strong>ã€‚å³<strong>å“ˆå¸Œæ‰°åŠ¨</strong>ã€‚</p>
<p>ä»ä¸Šæ–‡å¯çŸ¥é«˜åŒºçš„16ä½ä¸åŸhashcodeç›¸æ¯”æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œä½åŒºçš„16ä½å‘ç”Ÿäº†å˜åŒ–ã€‚</p>
<p>æˆ‘ä»¬éƒ½çŸ¥é“é‡æ–°è®¡ç®—å‡ºçš„æ–°å“ˆå¸Œå€¼åœ¨åé¢å°†ä¼šå‚ä¸hashmapä¸­æ•°ç»„æ§½ä½çš„è®¡ç®—ï¼Œè®¡ç®—å…¬å¼ï¼š(n - 1) &amp; hashï¼Œå‡å¦‚è¿™æ—¶æ•°ç»„æ§½ä½æœ‰16ä¸ªï¼Œåˆ™æ§½ä½è®¡ç®—å¦‚ä¸‹ï¼š</p>
<p><img src="https://fabian.oss-cn-hangzhou.aliyuncs.com/img/image-20210924133141544.png" alt="image-20210924133141544"></p>
<p><strong>é«˜åŒºçš„16ä½å¾ˆæœ‰å¯èƒ½ä¼šè¢«æ•°ç»„æ§½ä½æ•°çš„äºŒè¿›åˆ¶ç å±è”½ï¼Œå¦‚æœæˆ‘ä»¬ä¸åšåˆšæ‰ç§»ä½å¼‚æˆ–è¿ç®—ï¼Œé‚£ä¹ˆåœ¨è®¡ç®—æ§½ä½æ—¶å°†ä¸¢å¤±é«˜åŒºç‰¹å¾</strong></p>
<p>ä¹Ÿè®¸ä½ å¯èƒ½ä¼šè¯´ï¼Œå³ä½¿ä¸¢å¤±äº†é«˜åŒºç‰¹å¾ä¸åŒhashcodeä¹Ÿå¯ä»¥è®¡ç®—å‡ºä¸åŒçš„æ§½ä½æ¥ï¼Œä½†æ˜¯ç»†æƒ³å½“ä¸¤ä¸ªå“ˆå¸Œç å¾ˆæ¥è¿‘æ—¶ï¼Œé‚£ä¹ˆè¿™é«˜åŒºçš„ä¸€ç‚¹ç‚¹å·®å¼‚å°±<strong>å¯èƒ½å¯¼è‡´ä¸€æ¬¡å“ˆå¸Œç¢°æ’</strong>ï¼Œæ‰€ä»¥è¿™ä¹Ÿæ˜¯å°†æ€§èƒ½åšåˆ°æè‡´çš„ä¸€ç§ä½“ç°</p>
<h3 id="å–ä½™-å’Œä½è¿ç®—-amp"><a href="#å–ä½™-å’Œä½è¿ç®—-amp" class="headerlink" title="å–ä½™ % å’Œä½è¿ç®— &amp;"></a>å–ä½™ % å’Œä½è¿ç®— &amp;</h3><p>æˆ‘ä»¬çœ‹åˆ°æºç ä¸­å­˜æ”¾å€¼çš„æ—¶å€™ï¼š<code>(n - 1) &amp; hash</code></p>
<p>ä¸€èˆ¬æ¥è¯´æˆ‘ä»¬çš„è®¤ä¸ºéƒ½æ˜¯å°† å“ˆå¸Œå€¼ å’Œæ•°ç»„çš„é•¿åº¦è¿›è¡Œå–æ¨¡è¿ç®—æ¥è·å¾—æ•°ç»„çš„ä¸‹æ ‡</p>
<ul>
<li>é‚£ä¹ˆè¿™é‡Œä¸»è¦è€ƒè™‘åˆ°çš„æ˜¯ï¼š<strong>ä½è¿ç®—ç›¸æ¯”å–æ¨¡è¿ç®—æ•ˆç‡æ›´é«˜</strong></li>
</ul>
<p>å…³äºä¸ºä»€ä¹ˆä½è¿ç®—èƒ½ä»£æ›¿å–æ¨¡è¿ç®—å¯ä»¥å‚è€ƒè¿™ä¸ª ğŸ‘‰<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.cnblogs.com/ysocean/p/9054804.html"><strong>ç”±HashMapå“ˆå¸Œç®—æ³•å¼•å‡ºçš„æ±‚ä½™%å’Œä¸è¿ç®—&amp;è½¬æ¢é—®é¢˜</strong></a></p>
<blockquote>
<p><strong>å½“ lenth &#x3D; 2n æ—¶ï¼ŒX % length &#x3D; X &amp; (length - 1)</strong></p>
<ul>
<li>ä¹Ÿå°±æ˜¯è¯´ï¼Œé•¿åº¦ä¸º2çš„næ¬¡å¹‚æ—¶ï¼Œæ¨¡è¿ç®— % å¯ä»¥å˜æ¢ä¸ºæŒ‰ä½ä¸ &amp; è¿ç®—ã€‚</li>
</ul>
<p>ã€€ã€€æ¯”å¦‚ï¼š9 % 4 &#x3D; 1ï¼Œ9çš„äºŒè¿›åˆ¶æ˜¯ 1001 ,4-1 &#x3D; 3,3çš„äºŒè¿›åˆ¶æ˜¯ 0011ã€‚ 9 &amp; 3 &#x3D; 1001 &amp; 0011 &#x3D; 0001 &#x3D; 1</p>
<p>ã€€ã€€å†æ¯”å¦‚ï¼š12 % 8 &#x3D; 4,12çš„äºŒè¿›åˆ¶æ˜¯ 1100,8-1 &#x3D; 7,7çš„äºŒè¿›åˆ¶æ˜¯ 0111ã€‚12 &amp; 7 &#x3D; 1100 &amp; 0111 &#x3D; 0100 &#x3D; 4</p>
<ul>
<li>ä¸Šé¢ä¸¤ä¸ªä¾‹å­4å’Œ8éƒ½æ˜¯2çš„næ¬¡å¹‚ï¼Œç»“è®ºæ˜¯æˆç«‹çš„ï¼Œé‚£ä¹ˆå½“é•¿åº¦ä¸ä¸º2çš„næ¬¡å¹‚å‘¢ï¼Ÿ</li>
</ul>
<p>ã€€ã€€æ¯”å¦‚ï¼š9 % 5 &#x3D; 4ï¼Œ9çš„äºŒè¿›åˆ¶æ˜¯ 1001ï¼Œ5-1 &#x3D; 4,4çš„äºŒè¿›åˆ¶æ˜¯0100ã€‚9 &amp; 4 &#x3D; 1001 &amp; 0100 &#x3D; 0000 &#x3D; 0ã€‚æ˜¾ç„¶æ˜¯ä¸æˆç«‹çš„ã€‚</p>
</blockquote>
<h2 id="äºŒã€å­˜å‚¨æ–¹å¼å’Œæ•°æ®ç»“æ„"><a href="#äºŒã€å­˜å‚¨æ–¹å¼å’Œæ•°æ®ç»“æ„" class="headerlink" title="äºŒã€å­˜å‚¨æ–¹å¼å’Œæ•°æ®ç»“æ„"></a>äºŒã€å­˜å‚¨æ–¹å¼å’Œæ•°æ®ç»“æ„</h2><blockquote>
<p>é—®ï¼šHashMapçš„åº•å±‚æ•°æ®ç»“æ„æ˜¯ä»€ä¹ˆ</p>
<p>ç­”ï¼šæ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘</p>
</blockquote>
<p><img src="https://fabian.oss-cn-hangzhou.aliyuncs.com/img/image-20210924142231035.png" alt="image-20210924142231035"></p>
<p>ä»ä¸Šé¢çš„å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºhashmapçš„å­˜å‚¨ç»“æ„ï¼Œé»˜è®¤æ˜¯æ•°ç»„+é“¾è¡¨çš„ç»“æ„ã€‚</p>
<p>å½“<strong>é“¾è¡¨çš„é•¿åº¦å¤§äº 8 (é»˜è®¤)</strong> çš„æ—¶å€™ï¼Œé“¾è¡¨ä¼šè½¬æ¢ä¸ºçº¢é»‘æ ‘ã€‚</p>
<ul>
<li><p>node çš„æ•°ç»„</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* The table, initialized on first use, and resized as</span></span><br><span class="line"><span class="comment">* necessary. When allocated, length is always a power of two.</span></span><br><span class="line"><span class="comment">* (We also tolerate length zero in some operations to allow</span></span><br><span class="line"><span class="comment">* bootstrapping mechanics that are currently not needed.)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">transient</span> Node&lt;K,V&gt;[] table;</span><br></pre></td></tr></table></figure>
</li>
<li><p>node ç»“ç‚¹</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Basic hash bin node, used for most entries.  (See below for</span></span><br><span class="line"><span class="comment">* TreeNode subclass, and in LinkedHashMap for its Entry subclass.)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Node</span>&lt;K,V&gt; <span class="keyword">implements</span> <span class="title class_">Map</span>.Entry&lt;K,V&gt; &#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">int</span> hash;</span><br><span class="line">    <span class="keyword">final</span> K key;</span><br><span class="line">    V value;</span><br><span class="line">    Node&lt;K,V&gt; next;</span><br><span class="line"></span><br><span class="line">    Node(<span class="type">int</span> hash, K key, V value, Node&lt;K,V&gt; next) &#123;</span><br><span class="line">        <span class="built_in">this</span>.hash = hash;</span><br><span class="line">        <span class="built_in">this</span>.key = key;</span><br><span class="line">        <span class="built_in">this</span>.value = value;</span><br><span class="line">        <span class="built_in">this</span>.next = next;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> K <span class="title function_">getKey</span><span class="params">()</span>        &#123; <span class="keyword">return</span> key; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> V <span class="title function_">getValue</span><span class="params">()</span>      &#123; <span class="keyword">return</span> value; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> String <span class="title function_">toString</span><span class="params">()</span> &#123; <span class="keyword">return</span> key + <span class="string">&quot;=&quot;</span> + value; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * nodeç»“ç‚¹çš„å“ˆå¸Œå€¼ï¼šå°† key çš„å“ˆå¸Œå€¼å’Œ value çš„å“ˆå¸Œå€¼è¿›è¡Œå¼‚æˆ–è¿ç®—</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="type">int</span> <span class="title function_">hashCode</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Objects.hashCode(key) ^ Objects.hashCode(value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> V <span class="title function_">setValue</span><span class="params">(V newValue)</span> &#123;</span><br><span class="line">        <span class="type">V</span> <span class="variable">oldValue</span> <span class="operator">=</span> value;</span><br><span class="line">        value = newValue;</span><br><span class="line">        <span class="keyword">return</span> oldValue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="type">boolean</span> <span class="title function_">equals</span><span class="params">(Object o)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (o == <span class="built_in">this</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (o <span class="keyword">instanceof</span> Map.Entry) &#123;</span><br><span class="line">            Map.Entry&lt;?,?&gt; e = (Map.Entry&lt;?,?&gt;)o;</span><br><span class="line">            <span class="keyword">if</span> (Objects.equals(key, e.getKey()) &amp;&amp;</span><br><span class="line">                Objects.equals(value, e.getValue()))</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>treenode ç»“ç‚¹</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Entry for Tree bins. Extends LinkedHashMap.Entry (which in turn</span></span><br><span class="line"><span class="comment">* extends Node) so can be used as extension of either regular or</span></span><br><span class="line"><span class="comment">* linked node.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">TreeNode</span>&lt;K,V&gt; <span class="keyword">extends</span> <span class="title class_">LinkedHashMap</span>.Entry&lt;K,V&gt; &#123;</span><br><span class="line">    TreeNode&lt;K,V&gt; parent;  <span class="comment">// red-black tree links</span></span><br><span class="line">    TreeNode&lt;K,V&gt; left;</span><br><span class="line">    TreeNode&lt;K,V&gt; right;</span><br><span class="line">    TreeNode&lt;K,V&gt; prev;    <span class="comment">// needed to unlink next upon deletion</span></span><br><span class="line">    <span class="type">boolean</span> red;</span><br><span class="line">    TreeNode(<span class="type">int</span> hash, K key, V val, Node&lt;K,V&gt; next) &#123;</span><br><span class="line">        <span class="built_in">super</span>(hash, key, val, next);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<blockquote>
<p>Hashmapä¸­çš„é“¾è¡¨å¤§å°è¶…è¿‡å…«ä¸ªæ—¶ä¼šè‡ªåŠ¨è½¬åŒ–ä¸ºçº¢é»‘æ ‘ï¼Œå½“åˆ é™¤å°äºå…­æ—¶é‡æ–°å˜ä¸ºé“¾è¡¨</p>
</blockquote>
<h2 id="ä¸‰ã€æ„é€ æ–¹æ³•å’Œåˆå§‹åŒ–"><a href="#ä¸‰ã€æ„é€ æ–¹æ³•å’Œåˆå§‹åŒ–" class="headerlink" title="ä¸‰ã€æ„é€ æ–¹æ³•å’Œåˆå§‹åŒ–"></a>ä¸‰ã€æ„é€ æ–¹æ³•å’Œåˆå§‹åŒ–</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Constructs an empty &lt;tt&gt;HashMap&lt;/tt&gt; with the specified initial</span></span><br><span class="line"><span class="comment"> * capacity and load factor.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span>  initialCapacity the initial capacity</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span>  loadFactor      the load factor</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@throws</span> IllegalArgumentException if the initial capacity is negative</span></span><br><span class="line"><span class="comment"> *         or the load factor is nonpositive</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">HashMap</span><span class="params">(<span class="type">int</span> initialCapacity, <span class="type">float</span> loadFactor)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (initialCapacity &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;Illegal initial capacity: &quot;</span> +</span><br><span class="line">                                           initialCapacity);</span><br><span class="line">    <span class="keyword">if</span> (initialCapacity &gt; MAXIMUM_CAPACITY)</span><br><span class="line">        initialCapacity = MAXIMUM_CAPACITY;</span><br><span class="line">    <span class="keyword">if</span> (loadFactor &lt;= <span class="number">0</span> || Float.isNaN(loadFactor))</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;Illegal load factor: &quot;</span> +</span><br><span class="line">                                           loadFactor);</span><br><span class="line">    <span class="built_in">this</span>.loadFactor = loadFactor;</span><br><span class="line">    <span class="built_in">this</span>.threshold = tableSizeFor(initialCapacity);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªæ˜¯æœ€åè¢«è°ƒç”¨çš„æ„é€ æ–¹æ³•ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯å…ˆç»™ hashmap åˆå§‹ä¸¤ä¸ªå€¼ï¼š<strong>initialCapacity</strong> å’Œ <strong>loadFactor</strong>ï¼šå³åˆå§‹å®¹é‡å’Œè´Ÿè½½å› å­</p>
<h3 id="1-åˆå§‹å®¹é‡-initialCapacity"><a href="#1-åˆå§‹å®¹é‡-initialCapacity" class="headerlink" title="1. åˆå§‹å®¹é‡ initialCapacity"></a>1. åˆå§‹å®¹é‡ initialCapacity</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è·å– æ¯” cap å¤§çš„æœ€å°çš„äºŒè¿›åˆ¶æ•°</span></span><br><span class="line"><span class="comment"> * Returns a power of two size for the given target capacity.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="title function_">tableSizeFor</span><span class="params">(<span class="type">int</span> cap)</span> &#123;</span><br><span class="line">    <span class="comment">// é¿å… è¾“å…¥ä¸º2çš„å¹‚æ—¶ è¿”å›äº† cap * 2</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> cap - <span class="number">1</span>;</span><br><span class="line">    n |= n &gt;&gt;&gt; <span class="number">1</span>;</span><br><span class="line">    n |= n &gt;&gt;&gt; <span class="number">2</span>;</span><br><span class="line">    n |= n &gt;&gt;&gt; <span class="number">4</span>;</span><br><span class="line">    n |= n &gt;&gt;&gt; <span class="number">8</span>;</span><br><span class="line">    n |= n &gt;&gt;&gt; <span class="number">16</span>;</span><br><span class="line">    <span class="keyword">return</span> (n &lt; <span class="number">0</span>) ? <span class="number">1</span> : (n &gt;= MAXIMUM_CAPACITY) ? MAXIMUM_CAPACITY : n + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæˆ‘ä»¬ä»¥è¾“å…¥ 9 ä¸ºä¾‹</p>
<ol>
<li><p>n &#x3D; cap - 1;</p>
<p><strong>è¿™é‡Œå¦‚æœç›´æ¥æ²¡æœ‰ -1 æ“ä½œï¼Œå¦‚æœè¾“å…¥çš„ä¸º2çš„å¹‚ï¼Œè¡¥1ä¹‹åå†+1ï¼Œå°±ä¸ä¼šè¿”å›åŸå€¼è€Œæ˜¯ cap*2</strong></p>
<p>n &#x3D;  00000000 00000000 00000000 00001000</p>
</li>
<li><p>n |&#x3D; n &gt;&gt;&gt; 1</p>
<p>00000000 00000000 00000000 00001000  n</p>
<p>00000000 00000000 00000000 00000100  n &gt;&gt;&gt; 1</p>
<p>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</p>
<p>00000000 00000000 00000000 00001100 &#x3D;&gt; n  </p>
</li>
<li><p>n |&#x3D; n &gt;&gt;&gt; 2</p>
<p>00000000 00000000 00000000 00001101  n</p>
<p>00000000 00000000 00000000 00000011  n &gt;&gt;&gt; 2</p>
<p>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</p>
<p>00000000 00000000 00000000 00001111 &#x3D;&gt; n  </p>
</li>
<li><p>åç»­æ“ä½œä½¿å¾—åç»­å…¨ä¸ºä¸€</p>
</li>
<li><p>æœ€åæ£€æŸ¥ å¤§äºé›¶ä¸”å°äºæœ€å¤§å€¼ï¼Œå°†ç»“æœåŠ ä¸€è¿”å›ï¼š16</p>
</li>
</ol>
<h3 id="2-è´Ÿè½½å› å­-loadFactor"><a href="#2-è´Ÿè½½å› å­-loadFactor" class="headerlink" title="2. è´Ÿè½½å› å­ loadFactor"></a>2. è´Ÿè½½å› å­ loadFactor</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The load factor used when none specified in constructor.</span></span><br><span class="line"><span class="comment"> * è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° jdk é»˜è®¤çš„è´Ÿè½½å› å­ä¸º 0.75ã€‚å½“åˆå§‹åŒ–æœªæŒ‡å®šæ—¶å°±é‡‡ç”¨æ­¤å€¼ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="type">float</span> <span class="variable">DEFAULT_LOAD_FACTOR</span> <span class="operator">=</span> <span class="number">0.75f</span>;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªå€¼å’Œæˆ‘ä»¬hashmapçš„æ‰©å®¹æœ‰å…³ï¼š<strong>æ¯”å¦‚è¯´å½“å‰çš„å®¹å™¨å®¹é‡æ˜¯16ï¼Œè´Ÿè½½å› å­æ˜¯0.75,16*0.75&#x3D;12ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“å®¹é‡è¾¾åˆ°äº†12çš„æ—¶å€™å°±ä¼šè¿›è¡Œæ‰©å®¹æ“ä½œ</strong></p>
<p>æ­¤å¤„æˆ‘ä»¬å¯ä»¥ä»æ—¶é—´å’Œç©ºé—´çš„è§’åº¦æ¥è€ƒè™‘ï¼š</p>
<ul>
<li><strong>å½“è´Ÿè½½å› å­çš„å€¼ä¸º 1</strong><ul>
<li>æ­¤æ—¶åªæœ‰å½“ node æ•°ç»„è¢«å¡«æ»¡æ—¶æ‰ä¼šè¿›è¡Œæ‰©å®¹</li>
<li>æ—¢ç„¶å“ˆå¸Œç¢°æ’æ˜¯ä¸å¯é¿å…çš„ï¼Œé‚£ä¹ˆæ­¤æ—¶åº•å±‚çš„çº¢é»‘æ ‘ç»“æ„å°±ä¼šå˜å¾—å¼‚å¸¸å¤æ‚ï¼Œæ˜æ˜¾ä¼šé™ä½æŸ¥è¯¢æ•ˆç‡</li>
<li>æ—¶é—´æ¢ç©ºé—´</li>
</ul>
</li>
<li><strong>å½“è´Ÿè½½å› å­çš„å€¼ä¸º 0.5</strong><ul>
<li>æ­¤æ—¶å½“ node æ•°ç»„è¢«å¡«å……è¶…è¿‡ä¸€åŠå°±ä¼šè¿›è¡Œæ‰©å®¹</li>
<li>é‚£ä¹ˆè™½ç„¶å¯ä»¥é™ä½åº•å±‚çº¢é»‘æ ‘çš„ç»“æ„æé«˜æŸ¥æ‰¾æ•ˆç‡ï¼Œä¹Ÿæ— ç–‘ç‰ºç‰²äº†ä¸€åŠçš„å­˜å‚¨ç©ºé—´</li>
<li>ç©ºé—´æ¢æ—¶é—´</li>
</ul>
</li>
</ul>
<p>æ‰€ä»¥ 0.75 çš„é€‰æ‹©å¯ä»¥è¯´æ˜¯ç©ºé—´å’Œæ—¶é—´çš„æƒè¡¡ã€‚ä½†æœ€åçš„ 0.75 ä¹Ÿå¹¶ä¸æ˜¯ç®€å•çš„ 0.5 å’Œ 1 çš„æŠ˜ä¸­ã€‚</p>
<p>æ ¹æ®æºç çš„æ³¨é‡Šï¼Œé‡Œé¢æ¶‰åŠåˆ°ä¸€äº›ç»Ÿè®¡å­¦æ–¹é¢çš„æ³Šæ¾åˆ†å¸ƒçš„è®¡ç®—ï¼Œè¿™é‡Œå°±ä¸å±•å¼€ç»†è¯´äº†ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Ideally, under random hashCodes, the frequency of</span></span><br><span class="line"><span class="comment">* nodes in bins follows a Poisson distribution</span></span><br><span class="line"><span class="comment">* (http://en.wikipedia.org/wiki/Poisson_distribution) with a</span></span><br><span class="line"><span class="comment">* parameter of about 0.5 on average for the default resizing</span></span><br><span class="line"><span class="comment">* threshold of 0.75, although with a large variance because of</span></span><br><span class="line"><span class="comment">* resizing granularity. Ignoring variance, the expected</span></span><br><span class="line"><span class="comment">* occurrences of list size k are (exp(-0.5) * pow(0.5, k) /</span></span><br><span class="line"><span class="comment">* factorial(k)). The first values are:</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* 0:    0.60653066</span></span><br><span class="line"><span class="comment">* 1:    0.30326533</span></span><br><span class="line"><span class="comment">* 2:    0.07581633</span></span><br><span class="line"><span class="comment">* 3:    0.01263606</span></span><br><span class="line"><span class="comment">* 4:    0.00157952</span></span><br><span class="line"><span class="comment">* 5:    0.00015795</span></span><br><span class="line"><span class="comment">* 6:    0.00001316</span></span><br><span class="line"><span class="comment">* 7:    0.00000094</span></span><br><span class="line"><span class="comment">* 8:    0.00000006</span></span><br><span class="line"><span class="comment">* more: less than 1 in ten million</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<h2 id="å››ã€æ·»åŠ å…ƒç´ å’ŒæŸ¥æ‰¾å…ƒç´ "><a href="#å››ã€æ·»åŠ å…ƒç´ å’ŒæŸ¥æ‰¾å…ƒç´ " class="headerlink" title="å››ã€æ·»åŠ å…ƒç´ å’ŒæŸ¥æ‰¾å…ƒç´ "></a>å››ã€æ·»åŠ å…ƒç´ å’ŒæŸ¥æ‰¾å…ƒç´ </h2><h3 id="1-put-æ–¹æ³•"><a href="#1-put-æ–¹æ³•" class="headerlink" title="1. put æ–¹æ³•"></a>1. put æ–¹æ³•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Associates the specified value with the specified key in this map.</span></span><br><span class="line"><span class="comment"> * If the map previously contained a mapping for the key, the old</span></span><br><span class="line"><span class="comment"> * value is replaced.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> key key with which the specified value is to be associated</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> value value to be associated with the specified key</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> the previous value associated with &lt;tt&gt;key&lt;/tt&gt;, or</span></span><br><span class="line"><span class="comment"> *         &lt;tt&gt;null&lt;/tt&gt; if there was no mapping for &lt;tt&gt;key&lt;/tt&gt;.</span></span><br><span class="line"><span class="comment"> *         (A &lt;tt&gt;null&lt;/tt&gt; return can also indicate that the map</span></span><br><span class="line"><span class="comment"> *         previously associated &lt;tt&gt;null&lt;/tt&gt; with &lt;tt&gt;key&lt;/tt&gt;.)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> V <span class="title function_">put</span><span class="params">(K key, V value)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> putVal(hash(key), key, value, <span class="literal">false</span>, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>è¿™é‡Œè´´ä¸€å¼ æµç¨‹å›¾å¹¶ä¸”é™„ä¸ŠåŠ äº†æ³¨é‡Šçš„æºç </strong></p>
<p><img src="https://fabian.oss-cn-hangzhou.aliyuncs.com/img/image-20210927232504843.png" alt="image-20210927232504843"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Implements Map.put and related methods.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> hash 	å¯†é’¥çš„æ•£åˆ—</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> key 	é”®å€¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> value 	è¦æ”¾ç½®çš„å€¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> onlyIfAbsent 	å¦‚æœä¸ºçœŸï¼Œåˆ™ä¸æ›´æ”¹ç°æœ‰å€¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> evict 	å¦‚æœä¸º falseï¼Œåˆ™è¡¨å¤„äºåˆ›å»ºæ¨¡å¼ã€‚</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 	ä»¥å‰çš„å€¼ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™ä¸º null</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">final</span> V <span class="title function_">putVal</span><span class="params">(<span class="type">int</span> hash, K key, V value, <span class="type">boolean</span> onlyIfAbsent,</span></span><br><span class="line"><span class="params">               <span class="type">boolean</span> evict)</span> &#123;</span><br><span class="line"></span><br><span class="line">    Node&lt;K,V&gt;[] tab;</span><br><span class="line">    Node&lt;K,V&gt; p;</span><br><span class="line">    <span class="type">int</span> n, i;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// tableæ•°ç»„ä¸ºç©ºæˆ–è€…é•¿åº¦ä¸ºé›¶åˆ™ è°ƒç”¨ resize() æ¥åˆå§‹åŒ–æ•°ç»„</span></span><br><span class="line">    <span class="keyword">if</span> ((tab = table) == <span class="literal">null</span> || (n = tab.length) == <span class="number">0</span>)</span><br><span class="line">        n = (tab = resize()).length;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¡ç®—æ•°ç»„ä¸‹æ ‡ï¼Œå¦‚æœç»“ç‚¹ä¸ºç©ºåˆ™æ–°å»ºç»“ç‚¹æ”¾å…¥</span></span><br><span class="line">    <span class="keyword">if</span> ((p = tab[i = (n - <span class="number">1</span>) &amp; hash]) == <span class="literal">null</span>)</span><br><span class="line">        tab[i] = newNode(hash, key, value, <span class="literal">null</span>);</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">        Node&lt;K,V&gt; e;</span><br><span class="line">        K k;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¦‚æœå’Œå¤´èŠ‚ç‚¹å“ˆå¸Œå€¼ç›¸ç­‰ï¼Œåˆ™ç›´æ¥å‘½ä¸­å¤´èŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">if</span> (p.hash == hash &amp;&amp;</span><br><span class="line">            ((k = p.key) == key || (key != <span class="literal">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">            e = p;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¦‚æœæ˜¯æ ‘èŠ‚ç‚¹è¿›è¡Œçº¢é»‘æ ‘çš„æ“ä½œ</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (p <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">            e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(<span class="built_in">this</span>, tab, hash, key, value);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å‰©ä¸‹çš„å°±æ˜¯é“¾è¡¨èŠ‚ç‚¹æ“ä½œ</span></span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">binCount</span> <span class="operator">=</span> <span class="number">0</span>; ; ++binCount) &#123;</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// èµ°åˆ°å°¾ç»“ç‚¹åˆ™æ–°å»ºèŠ‚ç‚¹è¿½åŠ åœ¨åé¢</span></span><br><span class="line">                <span class="keyword">if</span> ((e = p.next) == <span class="literal">null</span>) &#123;</span><br><span class="line">                    p.next = newNode(hash, key, value, <span class="literal">null</span>);</span><br><span class="line">                    </span><br><span class="line">                    <span class="comment">// å¦‚æœé“¾è¡¨é•¿åº¦è¶…è¿‡é˜ˆå€¼åˆ™è½¬åŒ–ä¸ºçº¢é»‘æ ‘</span></span><br><span class="line">                    <span class="keyword">if</span> (binCount &gt;= TREEIFY_THRESHOLD - <span class="number">1</span>) <span class="comment">// -1 for 1st</span></span><br><span class="line">                        treeifyBin(tab, hash);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// å½“æœªèµ°åˆ°å°¾ç»“ç‚¹æ—¶ï¼Œæ ¹æ®å“ˆå¸Œå€¼æ˜¯å¦ç›¸ç­‰æ¥åˆ¤æ–­æ˜¯å¦å‘½ä¸­</span></span><br><span class="line">                <span class="keyword">if</span> (e.hash == hash &amp;&amp;</span><br><span class="line">                    ((k = e.key) == key || (key != <span class="literal">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                p = e;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (e != <span class="literal">null</span>) &#123; <span class="comment">// existing mapping for key</span></span><br><span class="line">            <span class="type">V</span> <span class="variable">oldValue</span> <span class="operator">=</span> e.value;</span><br><span class="line">            <span class="comment">// æ ¹æ®æ ‡è¯†ä½åˆ¤æ–­æ˜¯å¦æ›¿æ¢</span></span><br><span class="line">            <span class="keyword">if</span> (!onlyIfAbsent || oldValue == <span class="literal">null</span>)</span><br><span class="line">                e.value = value;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// æä¾›ç»™ LinkedHashMap çš„å›è°ƒ</span></span><br><span class="line">            afterNodeAccess(e);</span><br><span class="line">            <span class="keyword">return</span> oldValue;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ›´æ–°ä¿®æ”¹æ¬¡æ•°æ¥ä¿è¯è¿­ä»£å™¨çš„å¿«é€Ÿå¤±è´¥æœºåˆ¶</span></span><br><span class="line">    ++modCount;</span><br><span class="line">    <span class="comment">// è¶…è¿‡é˜ˆå€¼å°±æ‰©å®¹</span></span><br><span class="line">    <span class="keyword">if</span> (++size &gt; threshold)</span><br><span class="line">        resize();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æä¾›ç»™ LinkedHashMap çš„å›è°ƒ</span></span><br><span class="line">    afterNodeInsertion(evict);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-get-æ–¹æ³•-å’Œ-containsKey-æ–¹æ³•"><a href="#2-get-æ–¹æ³•-å’Œ-containsKey-æ–¹æ³•" class="headerlink" title="2. get æ–¹æ³• å’Œ containsKey æ–¹æ³•"></a>2. get æ–¹æ³• å’Œ containsKey æ–¹æ³•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> V <span class="title function_">get</span><span class="params">(Object key)</span> &#123;</span><br><span class="line">    Node&lt;K,V&gt; e;</span><br><span class="line">    <span class="keyword">return</span> (e = getNode(hash(key), key)) == <span class="literal">null</span> ? <span class="literal">null</span> : e.value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">containsKey</span><span class="params">(Object key)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> getNode(hash(key), key) != <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åº•å±‚éƒ½æ˜¯è°ƒç”¨äº† <code>getNode()</code>è¿™ä¸ªæ–¹æ³•é€šè¿‡å“ˆå¸Œå€¼å’Œé”®å€¼å»æœç´¢ç»“ç‚¹</p>
<p><code>containsKey</code>ï¼šå¦‚æœæ‰¾åˆ°ç»“ç‚¹åˆ™è¿”å› trueï¼Œå¦åˆ™è¿”å› false</p>
<p><code>get</code>ï¼šå¦‚æœæ‰¾åˆ°ç»“ç‚¹è¿”å›ç»“ç‚¹çš„ value å€¼ï¼Œå¦åˆ™è¿”å› null</p>
<ul>
<li>ä¸è¿‡è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œå¦‚æœè¿”å›äº† null å¯èƒ½æœ‰<strong>ä¸¤ç§åŸå› </strong>ï¼š<ol>
<li><strong>key ä¸å­˜åœ¨</strong></li>
<li><strong>key å­˜åœ¨ï¼Œä½†æ˜¯å­˜å‚¨çš„ç»“æœä¸º null</strong></li>
</ol>
</li>
</ul>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> Node&lt;K,V&gt; <span class="title function_">getNode</span><span class="params">(<span class="type">int</span> hash, Object key)</span> &#123;</span><br><span class="line">    </span><br><span class="line">    Node&lt;K,V&gt;[] tab; </span><br><span class="line">    Node&lt;K,V&gt; first, e; </span><br><span class="line">    <span class="type">int</span> n; </span><br><span class="line">    K k;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ((tab = table) != <span class="literal">null</span> &amp;&amp; (n = tab.length) &gt; <span class="number">0</span> &amp;&amp;</span><br><span class="line">        (first = tab[(n - <span class="number">1</span>) &amp; hash]) != <span class="literal">null</span>) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å…ˆå¯¹å¤´èŠ‚ç‚¹åšåˆ¤æ–­</span></span><br><span class="line">        <span class="keyword">if</span> (first.hash == hash &amp;&amp; <span class="comment">// always check first node</span></span><br><span class="line">            ((k = first.key) == key || (key != <span class="literal">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">            <span class="keyword">return</span> first;</span><br><span class="line">        <span class="keyword">if</span> ((e = first.next) != <span class="literal">null</span>) &#123;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// å¦‚æœæ˜¯çº¢é»‘æ ‘ç»“ç‚¹</span></span><br><span class="line">            <span class="keyword">if</span> (first <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">                <span class="keyword">return</span> ((TreeNode&lt;K,V&gt;)first).getTreeNode(hash, key);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// æœ€åéå†é“¾è¡¨</span></span><br><span class="line">            <span class="keyword">do</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (e.hash == hash &amp;&amp;</span><br><span class="line">                    ((k = e.key) == key || (key != <span class="literal">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">                    <span class="keyword">return</span> e;</span><br><span class="line">            &#125; <span class="keyword">while</span> ((e = e.next) != <span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="äº”ã€æ‰©å®¹å’Œrehash"><a href="#äº”ã€æ‰©å®¹å’Œrehash" class="headerlink" title="äº”ã€æ‰©å®¹å’Œrehash"></a>äº”ã€æ‰©å®¹å’Œrehash</h2><p>è¿™é‡Œæˆ‘ä»¬å…ˆä¸Š<code>resize()</code>å‡½æ•°çš„æºç </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> Node&lt;K,V&gt;[] resize() &#123;</span><br><span class="line">    Node&lt;K,V&gt;[] oldTab = table;</span><br><span class="line">    <span class="type">int</span> <span class="variable">oldCap</span> <span class="operator">=</span> (oldTab == <span class="literal">null</span>) ? <span class="number">0</span> : oldTab.length;</span><br><span class="line">    <span class="type">int</span> <span class="variable">oldThr</span> <span class="operator">=</span> threshold;</span><br><span class="line">    <span class="type">int</span> newCap, newThr = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// å½“åŸç»“æ„æœ‰æ•°æ®çš„æ—¶å€™</span></span><br><span class="line">    <span class="keyword">if</span> (oldCap &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœä¹‹å‰çš„å®¹é‡å¤§äºæœ€å¤§å®¹é‡ï¼Œå³å°†é˜ˆå€¼è°ƒæ•´åˆ°æœ€å¤§å¹¶ä¸å†æ‰©å®¹</span></span><br><span class="line">        <span class="keyword">if</span> (oldCap &gt;= MAXIMUM_CAPACITY) &#123;</span><br><span class="line">            threshold = Integer.MAX_VALUE;</span><br><span class="line">            <span class="keyword">return</span> oldTab;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å½“æ–°å®¹é‡å°äºæœ€å¤§å®¹é‡ æ—§å®¹é‡å¤§äºé»˜è®¤åˆå§‹å€¼æ—¶ï¼Œå¯¹é˜ˆå€¼ double</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ((newCap = oldCap &lt;&lt; <span class="number">1</span>) &lt; MAXIMUM_CAPACITY &amp;&amp;</span><br><span class="line">                 oldCap &gt;= DEFAULT_INITIAL_CAPACITY)</span><br><span class="line">            newThr = oldThr &lt;&lt; <span class="number">1</span>; <span class="comment">// double threshold</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœä¸€å¼€å§‹ç»™å®šäº†åˆå§‹å®¹é‡ï¼Œå°±å–åˆå§‹åŒ–æ—¶çš„å€¼</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (oldThr &gt; <span class="number">0</span>) <span class="comment">// initial capacity was placed in threshold</span></span><br><span class="line">        newCap = oldThr;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æœ€åé‡‡å–é»˜è®¤å€¼</span></span><br><span class="line">    <span class="keyword">else</span> &#123;               <span class="comment">// zero initial threshold signifies using defaults</span></span><br><span class="line">        newCap = DEFAULT_INITIAL_CAPACITY;</span><br><span class="line">        newThr = (<span class="type">int</span>)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é€šè¿‡æœ€å¤§å®¹é‡å’Œè´Ÿè½½å› å­è®¡ç®—é˜ˆå€¼</span></span><br><span class="line">    <span class="keyword">if</span> (newThr == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="type">float</span> <span class="variable">ft</span> <span class="operator">=</span> (<span class="type">float</span>)newCap * loadFactor;</span><br><span class="line">        newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (<span class="type">float</span>)MAXIMUM_CAPACITY ?</span><br><span class="line">                  (<span class="type">int</span>)ft : Integer.MAX_VALUE);</span><br><span class="line">    &#125;</span><br><span class="line">    threshold = newThr;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ ¹æ® newCap åˆ›å»ºæ–°çš„æ•°ç»„</span></span><br><span class="line">    <span class="meta">@SuppressWarnings(&#123;&quot;rawtypes&quot;,&quot;unchecked&quot;&#125;)</span></span><br><span class="line">    Node&lt;K,V&gt;[] newTab = (Node&lt;K,V&gt;[])<span class="keyword">new</span> <span class="title class_">Node</span>[newCap];</span><br><span class="line">    table = newTab;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœä¸ä¸ºç©ºï¼Œæ¬è¿ä¹‹å‰mapçš„å­˜å‚¨å†…å®¹ï¼Œéå†æ¯ä¸€ä¸ªæ•°ç»„</span></span><br><span class="line">    <span class="keyword">if</span> (oldTab != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; oldCap; ++j) &#123;</span><br><span class="line">            Node&lt;K,V&gt; e;</span><br><span class="line">            <span class="keyword">if</span> ((e = oldTab[j]) != <span class="literal">null</span>) &#123;</span><br><span class="line">                oldTab[j] = <span class="literal">null</span>;</span><br><span class="line">                <span class="keyword">if</span> (e.next == <span class="literal">null</span>)</span><br><span class="line">                    newTab[e.hash &amp; (newCap - <span class="number">1</span>)] = e;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (e <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">                    ((TreeNode&lt;K,V&gt;)e).split(<span class="built_in">this</span>, newTab, j, oldCap);</span><br><span class="line">                <span class="keyword">else</span> &#123; <span class="comment">// preserve order</span></span><br><span class="line">                    <span class="comment">// å°†é“¾è¡¨åˆ†æˆä¸¤ä¸ªç»„ï¼Œæ ¹æ®å“ˆå¸Œå€¼ä¸€éƒ¨åˆ†ç•™åœ¨åŸæ¥æ•°ç»„ä½ç½®ï¼Œä¸€éƒ¨åˆ†å‘å‰ oldCap</span></span><br><span class="line">                    Node&lt;K,V&gt; loHead = <span class="literal">null</span>, loTail = <span class="literal">null</span>;</span><br><span class="line">                    Node&lt;K,V&gt; hiHead = <span class="literal">null</span>, hiTail = <span class="literal">null</span>;</span><br><span class="line">                    Node&lt;K,V&gt; next;</span><br><span class="line">                    <span class="keyword">do</span> &#123;</span><br><span class="line">                        next = e.next;</span><br><span class="line">                        <span class="keyword">if</span> ((e.hash &amp; oldCap) == <span class="number">0</span>) &#123;</span><br><span class="line">                            <span class="keyword">if</span> (loTail == <span class="literal">null</span>)</span><br><span class="line">                                loHead = e;</span><br><span class="line">                            <span class="keyword">else</span></span><br><span class="line">                                loTail.next = e;</span><br><span class="line">                            loTail = e;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> &#123;</span><br><span class="line">                            <span class="keyword">if</span> (hiTail == <span class="literal">null</span>)</span><br><span class="line">                                hiHead = e;</span><br><span class="line">                            <span class="keyword">else</span></span><br><span class="line">                                hiTail.next = e;</span><br><span class="line">                            hiTail = e;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">while</span> ((e = next) != <span class="literal">null</span>);</span><br><span class="line">                    <span class="keyword">if</span> (loTail != <span class="literal">null</span>) &#123;</span><br><span class="line">                        loTail.next = <span class="literal">null</span>;</span><br><span class="line">                        newTab[j] = loHead;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (hiTail != <span class="literal">null</span>) &#123;</span><br><span class="line">                        hiTail.next = <span class="literal">null</span>;</span><br><span class="line">                        newTab[j + oldCap] = hiHead;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> newTab;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªå‡½æ•°ä¸€èˆ¬æä¾›ä¸¤ä¸ªåŠŸèƒ½ï¼š</p>
<ul>
<li>åœ¨æ„é€ å‡½æ•°ä¹‹åï¼Œç¬¬ä¸€æ¬¡<code>put()</code>å‘ç°æ•°ç»„ä¸ºç©ºåˆ™ä¼šè°ƒç”¨ï¼Œå®ç°æ‡’åŠ è½½</li>
<li>å½“å­˜å‚¨çš„æ•°æ®è¶…è¿‡é˜ˆå€¼æ—¶è°ƒç”¨ï¼Œæ¥å®ç°æ‰©å®¹</li>
</ul>
<p><strong>ç»è¿‡rehashä¹‹åï¼Œå…ƒç´ çš„ä½ç½®è¦ä¹ˆæ˜¯åœ¨åŸä½ç½®ï¼Œè¦ä¹ˆæ˜¯åœ¨åŸä½ç½®å†ç§»åŠ¨2æ¬¡å¹‚çš„ä½ç½®</strong></p>
<p><img src="https://fabian.oss-cn-hangzhou.aliyuncs.com/img/image-20210929231418128.png" alt="image-20210929231418128"></p>
<p><img src="https://fabian.oss-cn-hangzhou.aliyuncs.com/img/image-20210929231439803.png" alt="image-20210929231439803"></p>
<p><img src="https://fabian.oss-cn-hangzhou.aliyuncs.com/img/image-20210929231504675.png" alt="image-20210929231504675"></p>
<blockquote>
<ul>
<li><p>æ‰©å®¹æ˜¯ä¸€ä¸ªç‰¹åˆ«è€—æ€§èƒ½çš„æ“ä½œï¼Œæ‰€ä»¥å½“ç¨‹åºå‘˜åœ¨ä½¿ç”¨HashMapçš„æ—¶å€™ï¼Œä¼°ç®—mapçš„å¤§å°ï¼Œåˆå§‹åŒ–çš„æ—¶å€™ç»™ä¸€ä¸ªå¤§è‡´çš„æ•°å€¼ï¼Œé¿å…mapè¿›è¡Œé¢‘ç¹çš„æ‰©å®¹ã€‚</p>
</li>
<li><p>è´Ÿè½½å› å­æ˜¯å¯ä»¥ä¿®æ”¹çš„ï¼Œä¹Ÿå¯ä»¥å¤§äº1ï¼Œä½†æ˜¯å»ºè®®ä¸è¦è½»æ˜“ä¿®æ”¹ï¼Œé™¤éæƒ…å†µéå¸¸ç‰¹æ®Šã€‚</p>
</li>
</ul>
</blockquote>
<h2 id="å…­ã€å¤´æ’æ³•å’Œå°¾æ’æ³•"><a href="#å…­ã€å¤´æ’æ³•å’Œå°¾æ’æ³•" class="headerlink" title="å…­ã€å¤´æ’æ³•å’Œå°¾æ’æ³•"></a>å…­ã€å¤´æ’æ³•å’Œå°¾æ’æ³•</h2><blockquote>
<p>JDK8ä»¥å‰æ˜¯å¤´æ’æ³•ï¼ŒJDK8åæ˜¯å°¾æ’æ³•</p>
</blockquote>
<p>å¤´æ’æ³•å’Œå°¾æ’æ³•ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯æ’å…¥é“¾è¡¨çš„æ—¶å€™æ’å…¥åœ¨é“¾è¡¨å¤´éƒ¨è¿˜æ˜¯å°¾éƒ¨ã€‚</p>
<p><strong>ç”±äº<code>HashMap</code>åœ¨æ‰©å®¹æ—¶é‡‡ç”¨å¤´æ’æ³•ä¼šé€ æˆé“¾è¡¨æ­»å¾ªç¯ï¼Œæ•…åœ¨JDK8ä¹‹åè°ƒæ•´ä¸ºå°¾æ’æ³•</strong>ã€‚</p>
<p>è¿™é‡Œè´´ä¸€ä¸ªåˆ«äººçš„åˆ†æ</p>
<ul>
<li>å‰ææ¡ä»¶ï¼š<ol>
<li>hashç®—æ³•ä¸ºç®€å•çš„ç”¨key modé“¾è¡¨çš„å¤§å°ã€‚</li>
<li>æœ€å¼€å§‹hashè¡¨size&#x3D;2ï¼Œkey&#x3D;3,7,5ï¼Œåˆ™éƒ½åœ¨table[1]ä¸­ã€‚</li>
<li>ç„¶åè¿›è¡Œresizeï¼Œä½¿sizeå˜æˆ4ã€‚</li>
<li>æœªresizeå‰çš„æ•°æ®ç»“æ„å¦‚ä¸‹ï¼š</li>
</ol>
</li>
</ul>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/JdLkEI9sZfecWQvk4vhdQnUBzictjvKTV8KojY8VrMVmMVK0mT4Ric2icyc3icUzVuQCuLGpzOgZxOeHd8MgfgNuXQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="Image"></p>
<p>å¦‚æœåœ¨å•çº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œæœ€åçš„ç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/JdLkEI9sZfecWQvk4vhdQnUBzictjvKTVCB9USBX1WYQPWzj7iciaTjlyHZpq2MlWRasFGPLvXEM1zf0tiaictibYSsg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="Image"></p>
<p>è¿™é‡Œçš„è½¬ç§»è¿‡ç¨‹ï¼Œä¸å†è¿›è¡Œè¯¦è¿°ï¼Œåªè¦ç†è§£transferå‡½æ•°åœ¨åšä»€ä¹ˆï¼Œå…¶è½¬ç§»è¿‡ç¨‹ä»¥åŠå¦‚ä½•å¯¹é“¾è¡¨è¿›è¡Œåè½¬åº”è¯¥ä¸éš¾ã€‚</p>
<p>ç„¶ååœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œå‡è®¾æœ‰ä¸¤ä¸ªçº¿ç¨‹Aå’ŒBéƒ½åœ¨è¿›è¡Œputæ“ä½œã€‚çº¿ç¨‹Aåœ¨æ‰§è¡Œåˆ°transferå‡½æ•°ä¸­ç¬¬11è¡Œä»£ç å¤„æŒ‚èµ·ï¼Œå› ä¸ºè¯¥å‡½æ•°åœ¨è¿™é‡Œåˆ†æçš„åœ°ä½éå¸¸é‡è¦ï¼Œå› æ­¤å†æ¬¡è´´å‡ºæ¥ã€‚</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/JdLkEI9sZfecWQvk4vhdQnUBzictjvKTVRtdI81vOOgiayBNwiaru5saibodJiaUAxBsic9Clib8qu2SZWQd6MlokUF9g/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="Image"></p>
<p>æ­¤æ—¶çº¿ç¨‹Aä¸­è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/JdLkEI9sZfecWQvk4vhdQnUBzictjvKTVCrq6iaOLPVE0kE1zgCQYmWKTUPBGAm1icoUUR8ADvhUwTLoQ0jZzBr1g/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="Image"></p>
<p>çº¿ç¨‹AæŒ‚èµ·åï¼Œæ­¤æ—¶çº¿ç¨‹Bæ­£å¸¸æ‰§è¡Œï¼Œå¹¶å®Œæˆresizeæ“ä½œï¼Œç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/JdLkEI9sZfecWQvk4vhdQnUBzictjvKTVGWwiboVcEoovrdg7qUibUcwrLTuww3rbptiaFoZI11NaTj0tDAxybhwag/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="Image"></p>
<p><strong>è¿™é‡Œéœ€è¦ç‰¹åˆ«æ³¨æ„çš„ç‚¹ï¼šç”±äºçº¿ç¨‹Bå·²ç»æ‰§è¡Œå®Œæ¯•ï¼Œæ ¹æ®Javaå†…å­˜æ¨¡å‹ï¼Œç°åœ¨newTableå’Œtableä¸­çš„Entryéƒ½æ˜¯ä¸»å­˜ä¸­æœ€æ–°å€¼ï¼š7.next&#x3D;3ï¼Œ3.next&#x3D;nullã€‚</strong></p>
<p>æ­¤æ—¶åˆ‡æ¢åˆ°çº¿ç¨‹Aä¸Šï¼Œåœ¨çº¿ç¨‹AæŒ‚èµ·æ—¶å†…å­˜ä¸­å€¼å¦‚ä¸‹ï¼še&#x3D;3ï¼Œnext&#x3D;7ï¼ŒnewTable[3]&#x3D;nullï¼Œä»£ç æ‰§è¡Œè¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">newTable[3]=e ----&gt; newTable[3]=3</span><br><span class="line">e=next ----&gt; e=7</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶ç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/JdLkEI9sZfecWQvk4vhdQnUBzictjvKTVSPJ6RwE1NHxILdUiaIFib3NHncYPI6hfE0NvKWKu0UANfsFsWPicWKOvA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="Image"></p>
<p>ç»§ç»­å¾ªç¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">e=7</span><br><span class="line">next=e.next ----&gt; next=3ã€ä»ä¸»å­˜ä¸­å–å€¼ã€‘</span><br><span class="line">e.next=newTable[3] ----&gt; e.next=3ã€ä»ä¸»å­˜ä¸­å–å€¼ã€‘</span><br><span class="line">newTable[3]=e ----&gt; newTable[3]=7</span><br><span class="line">e=next ----&gt; e=3</span><br></pre></td></tr></table></figure>

<p>ç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/JdLkEI9sZfecWQvk4vhdQnUBzictjvKTVlVDoSg5Kvo0maS6h9RNZVRd7sMsZtu5homM7KI9ibEk47WtJXibgXfcg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="Image"></p>
<p>å†æ¬¡è¿›è¡Œå¾ªç¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">e=3</span><br><span class="line">next=e.next ----&gt; next=null</span><br><span class="line">e.next=newTable[3] ----&gt; e.next=7 å³ï¼š3.next=7</span><br><span class="line">newTable[3]=e ----&gt; newTable[3]=3</span><br><span class="line">e=next ----&gt; e=null</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„æ­¤æ¬¡å¾ªç¯ï¼še.next&#x3D;7ï¼Œè€Œåœ¨ä¸Šæ¬¡å¾ªç¯ä¸­7.next&#x3D;3ï¼Œå‡ºç°ç¯å½¢é“¾è¡¨ï¼Œå¹¶ä¸”æ­¤æ—¶e&#x3D;nullå¾ªç¯ç»“æŸã€‚</p>
<p>ç»“æœå¦‚ä¸‹ï¼š</p>
<p><strong><img src="https://mmbiz.qpic.cn/mmbiz_png/JdLkEI9sZfecWQvk4vhdQnUBzictjvKTVU7APPu5l0lKpFRwBS0KFISCE1h9iarAQnv7zpXz2k9DnZPIr2AWqhiaw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="Image"></strong></p>
<p>åœ¨åç»­æ“ä½œä¸­åªè¦æ¶‰åŠè½®è¯¢hashmapçš„æ•°æ®ç»“æ„ï¼Œå°±ä¼šåœ¨è¿™é‡Œå‘ç”Ÿæ­»å¾ªç¯ï¼Œé€ æˆæ‚²å‰§ã€‚</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="https://fabian4.site/blog">Fabian Bao</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://fabian4.site/blog/14375.html">https://fabian4.site/blog/14375.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://fabian4.site/blog" target="_blank">Fabian Bao</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/blog/tags/java/">java</a><a class="post-meta__tags" href="/blog/tags/%E6%BA%90%E7%A0%81/">æºç </a><a class="post-meta__tags" href="/blog/tags/jdk/">jdk</a><a class="post-meta__tags" href="/blog/tags/HashMap/">HashMap</a></div><div class="post_share"><div class="social-share" data-image="https://fabian.oss-cn-hangzhou.aliyuncs.com/img/LuciolaCruciata_ZH-CN9063767400_1920x1080.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> æ‰“èµ</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://fabian.oss-cn-hangzhou.aliyuncs.com/img/h3WuUjvQlqPEAzS.png" rel="external nofollow noreferrer" target="_blank"><img class="post-qr-code-img" src="https://fabian.oss-cn-hangzhou.aliyuncs.com/img/h3WuUjvQlqPEAzS.png" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="https://fabian.oss-cn-hangzhou.aliyuncs.com/img/9yaek4PwfNoZEHF.jpg" rel="external nofollow noreferrer" target="_blank"><img class="post-qr-code-img" src="https://fabian.oss-cn-hangzhou.aliyuncs.com/img/9yaek4PwfNoZEHF.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/blog/5986.html"><img class="prev-cover" src="https://fabian.oss-cn-hangzhou.aliyuncs.com/img/HallstattAustria_PT-BR9407016733_1920x1080.jpg" onerror="onerror=null;src='/blog/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">HashMapã€HashTableå’ŒConcurrentHashMap</div></div></a></div><div class="next-post pull-right"><a href="/blog/20209.html"><img class="next-cover" src="https://fabian.oss-cn-hangzhou.aliyuncs.com/img/ChefchaouenMorocco_ZH-CN6127993429_1920x1080.jpg" onerror="onerror=null;src='/blog/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">æºç ç¯å¢ƒæ­å»º</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/blog/5986.html" title="HashMapã€HashTableå’ŒConcurrentHashMap"><img class="cover" src="https://fabian.oss-cn-hangzhou.aliyuncs.com/img/HallstattAustria_PT-BR9407016733_1920x1080.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-04-03</div><div class="title">HashMapã€HashTableå’ŒConcurrentHashMap</div></div></a></div><div><a href="/blog/20209.html" title="æºç ç¯å¢ƒæ­å»º"><img class="cover" src="https://fabian.oss-cn-hangzhou.aliyuncs.com/img/ChefchaouenMorocco_ZH-CN6127993429_1920x1080.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-03-18</div><div class="title">æºç ç¯å¢ƒæ­å»º</div></div></a></div><div><a href="/blog/22066.html" title="Spring ä¸­çš„9ç§è®¾è®¡æ¨¡å¼"><img class="cover" src="https://fabian.oss-cn-hangzhou.aliyuncs.com/img/img-c6d3a2d229d395e79da66a8feff97814.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-03-10</div><div class="title">Spring ä¸­çš„9ç§è®¾è®¡æ¨¡å¼</div></div></a></div><div><a href="/blog/17692.html" title="æµ…è°ˆIoCå’ŒAOP"><img class="cover" src="https://fabian.oss-cn-hangzhou.aliyuncs.com/img/2c3XOeVFzLdnAE1.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-03-28</div><div class="title">æµ…è°ˆIoCå’ŒAOP</div></div></a></div><div><a href="/blog/60824.html" title="Spring Beané…ç½®â€”â€”æ³¨è§£é…Bean"><img class="cover" src="https://fabian.oss-cn-hangzhou.aliyuncs.com/img/UuKkAcjq6rZzs8v.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-04-05</div><div class="title">Spring Beané…ç½®â€”â€”æ³¨è§£é…Bean</div></div></a></div><div><a href="/blog/57175.html" title="Spring AOPçš„é…ç½®å’Œåº”ç”¨"><img class="cover" src="https://fabian.oss-cn-hangzhou.aliyuncs.com/img/186zIDlrCPFeuXQ.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-04-12</div><div class="title">Spring AOPçš„é…ç½®å’Œåº”ç”¨</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> è¯„è®º</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://fabian4.site/avatar.png" onerror="this.onerror=null;this.src='/blog/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Fabian Bao</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/blog/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">73</div></a><a href="/blog/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">54</div></a><a href="/blog/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">16</div></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">The best is yet to come</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#HashMap%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90"><span class="toc-number">1.</span> <span class="toc-text">HashMapæºç è§£æ</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AF-%E5%93%88%E5%B8%8C%EF%BC%8C-%E5%93%88%E5%B8%8C%E5%87%BD%E6%95%B0%EF%BC%88%E6%95%A3%E5%88%97%E5%87%BD%E6%95%B0%EF%BC%89"><span class="toc-number">1.1.</span> <span class="toc-text">ä¸€ã€ä»€ä¹ˆæ˜¯ å“ˆå¸Œï¼Œ å“ˆå¸Œå‡½æ•°ï¼ˆæ•£åˆ—å‡½æ•°ï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#object-%E4%B8%AD%E7%9A%84-hashcode-%E6%96%B9%E6%B3%95"><span class="toc-number">1.1.1.</span> <span class="toc-text">object ä¸­çš„ hashcode æ–¹æ³•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hashmap-%E9%87%87%E7%94%A8%E7%9A%84%E5%93%88%E5%B8%8C%E6%96%B9%E6%B3%95"><span class="toc-number">1.1.2.</span> <span class="toc-text">hashmap é‡‡ç”¨çš„å“ˆå¸Œæ–¹æ³•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%96%E4%BD%99-%E5%92%8C%E4%BD%8D%E8%BF%90%E7%AE%97-amp"><span class="toc-number">1.1.3.</span> <span class="toc-text">å–ä½™ % å’Œä½è¿ç®— &amp;</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%AD%98%E5%82%A8%E6%96%B9%E5%BC%8F%E5%92%8C%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-number">1.2.</span> <span class="toc-text">äºŒã€å­˜å‚¨æ–¹å¼å’Œæ•°æ®ç»“æ„</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95%E5%92%8C%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-number">1.3.</span> <span class="toc-text">ä¸‰ã€æ„é€ æ–¹æ³•å’Œåˆå§‹åŒ–</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%88%9D%E5%A7%8B%E5%AE%B9%E9%87%8F-initialCapacity"><span class="toc-number">1.3.1.</span> <span class="toc-text">1. åˆå§‹å®¹é‡ initialCapacity</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%B4%9F%E8%BD%BD%E5%9B%A0%E5%AD%90-loadFactor"><span class="toc-number">1.3.2.</span> <span class="toc-text">2. è´Ÿè½½å› å­ loadFactor</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E6%B7%BB%E5%8A%A0%E5%85%83%E7%B4%A0%E5%92%8C%E6%9F%A5%E6%89%BE%E5%85%83%E7%B4%A0"><span class="toc-number">1.4.</span> <span class="toc-text">å››ã€æ·»åŠ å…ƒç´ å’ŒæŸ¥æ‰¾å…ƒç´ </span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-put-%E6%96%B9%E6%B3%95"><span class="toc-number">1.4.1.</span> <span class="toc-text">1. put æ–¹æ³•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-get-%E6%96%B9%E6%B3%95-%E5%92%8C-containsKey-%E6%96%B9%E6%B3%95"><span class="toc-number">1.4.2.</span> <span class="toc-text">2. get æ–¹æ³• å’Œ containsKey æ–¹æ³•</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E6%89%A9%E5%AE%B9%E5%92%8Crehash"><span class="toc-number">1.5.</span> <span class="toc-text">äº”ã€æ‰©å®¹å’Œrehash</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E5%A4%B4%E6%8F%92%E6%B3%95%E5%92%8C%E5%B0%BE%E6%8F%92%E6%B3%95"><span class="toc-number">1.6.</span> <span class="toc-text">å…­ã€å¤´æ’æ³•å’Œå°¾æ’æ³•</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/blog/55079.html" title="Mysql æ‰§è¡Œæµç¨‹å’Œæ—¥å¿—ç³»ç»Ÿ"><img src="https://fabian.oss-cn-hangzhou.aliyuncs.com/img/Hatshepsut_ZH-CN4516192627_1920x1080.jpg" onerror="this.onerror=null;this.src='/blog/img/404.jpg'" alt="Mysql æ‰§è¡Œæµç¨‹å’Œæ—¥å¿—ç³»ç»Ÿ"/></a><div class="content"><a class="title" href="/blog/55079.html" title="Mysql æ‰§è¡Œæµç¨‹å’Œæ—¥å¿—ç³»ç»Ÿ">Mysql æ‰§è¡Œæµç¨‹å’Œæ—¥å¿—ç³»ç»Ÿ</a><time datetime="2021-05-14T16:00:00.000Z" title="å‘è¡¨äº 2021-05-15 00:00:00">2021-05-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/blog/47132.html" title="Mysql é”æœºåˆ¶"><img src="https://fabian.oss-cn-hangzhou.aliyuncs.com/img/Italica_ZH-CN1692906751_1920x1080.jpg" onerror="this.onerror=null;this.src='/blog/img/404.jpg'" alt="Mysql é”æœºåˆ¶"/></a><div class="content"><a class="title" href="/blog/47132.html" title="Mysql é”æœºåˆ¶">Mysql é”æœºåˆ¶</a><time datetime="2021-04-24T16:00:00.000Z" title="å‘è¡¨äº 2021-04-25 00:00:00">2021-04-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/blog/10729.html" title="Mysql éš”ç¦»çº§åˆ«ä¸MVCC"><img src="https://fabian.oss-cn-hangzhou.aliyuncs.com/img/CuscoCathedral_ZH-CN9834821723_1920x1080.jpg" onerror="this.onerror=null;this.src='/blog/img/404.jpg'" alt="Mysql éš”ç¦»çº§åˆ«ä¸MVCC"/></a><div class="content"><a class="title" href="/blog/10729.html" title="Mysql éš”ç¦»çº§åˆ«ä¸MVCC">Mysql éš”ç¦»çº§åˆ«ä¸MVCC</a><time datetime="2021-04-19T16:00:00.000Z" title="å‘è¡¨äº 2021-04-20 00:00:00">2021-04-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/blog/58885.html" title="æ•°æ®åº“å››å¤§æ€§è´¨å’Œéš”ç¦»ç­‰çº§"><img src="https://fabian.oss-cn-hangzhou.aliyuncs.com/img/ContainerShip_ZH-CN0850122021_1920x1080.jpg" onerror="this.onerror=null;this.src='/blog/img/404.jpg'" alt="æ•°æ®åº“å››å¤§æ€§è´¨å’Œéš”ç¦»ç­‰çº§"/></a><div class="content"><a class="title" href="/blog/58885.html" title="æ•°æ®åº“å››å¤§æ€§è´¨å’Œéš”ç¦»ç­‰çº§">æ•°æ®åº“å››å¤§æ€§è´¨å’Œéš”ç¦»ç­‰çº§</a><time datetime="2021-04-07T16:00:00.000Z" title="å‘è¡¨äº 2021-04-08 00:00:00">2021-04-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/blog/5986.html" title="HashMapã€HashTableå’ŒConcurrentHashMap"><img src="https://fabian.oss-cn-hangzhou.aliyuncs.com/img/HallstattAustria_PT-BR9407016733_1920x1080.jpg" onerror="this.onerror=null;this.src='/blog/img/404.jpg'" alt="HashMapã€HashTableå’ŒConcurrentHashMap"/></a><div class="content"><a class="title" href="/blog/5986.html" title="HashMapã€HashTableå’ŒConcurrentHashMap">HashMapã€HashTableå’ŒConcurrentHashMap</a><time datetime="2021-04-02T16:00:00.000Z" title="å‘è¡¨äº 2021-04-03 00:00:00">2021-04-03</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://fabian.oss-cn-hangzhou.aliyuncs.com/img/LuciolaCruciata_ZH-CN9063767400_1920x1080.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By Fabian Bao</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="ç®€ç¹è½¬æ¢">ç®€</button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/blog/js/utils.js"></script><script src="/blog/js/main.js"></script><script src="/blog/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"><script>function addGitalkSource () {
  const ele = document.createElement('link')
  ele.rel = 'stylesheet'
  ele.href= 'https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css'
  document.getElementsByTagName('head')[0].appendChild(ele)
}

function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk(Object.assign({
      clientID: '98fe0206dedd0d2caf96',
      clientSecret: '5f2816f58a108f15feba46f9bc88497d3d6457a4',
      repo: 'blog',
      owner: 'fabian4',
      admin: ['fabian4'],
      id: 'cdeb82ea60604f008f3810b890b2464a',
      updateCountCallback: commentCount
    },null))

    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    addGitalkSource()
    getScript('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.js').then(initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Gitalk' === 'Gitalk' || !false) {
  if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>